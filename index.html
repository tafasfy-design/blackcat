<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é»‘çŒ«çš„ä½è¯­</title>
    <!-- å¼•å…¥Tailwind CSSä»¥å¿«é€Ÿæ„å»ºç°ä»£åŒ–è®¾è®¡ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å¼•å…¥è‡ªå®šä¹‰å­—ä½“ -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Cormorant+Garamond:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* * è‡ªå®šä¹‰æ ·å¼
         * æˆ‘ä»¬åœ¨è¿™é‡Œå®šä¹‰åŸºç¡€æ°›å›´ã€å­—ä½“å’Œç‰¹æ®Šçš„è¾‰å…‰æ•ˆæœ
         */
        
        body {
            /* ä¸»è‰²è°ƒï¼šæ·±é‚ƒçš„åˆå¤œç´«è‰² */
            background-color: #100a1c;
            color: #e0e0e0;
            /* å­—ä½“ï¼šä¼˜å…ˆä½¿ç”¨è¡¬çº¿ä½“è¥é€ ç¥ç§˜æ„Ÿï¼Œå›è½åˆ°Interä¿è¯æ˜“è¯»æ€§ */
            font-family: 'Inter', 'Cormorant Garamond', sans-serif;
            overflow: hidden; /* éšè—æ»šåŠ¨æ¡ï¼Œä¿æŒæ²‰æµ¸æ„Ÿ */
            cursor: none; /* éšè—é»˜è®¤å…‰æ ‡ */
        }

        /* è‡ªå®šä¹‰å…‰æ ‡ */
        .custom-cursor {
            position: fixed;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: rgba(139, 92, 246, 0.7); /* ç¥ç§˜ç´«è‰² */
            border: 2px solid rgba(255, 255, 255, 0.8);
            left: 0;
            top: 0;
            pointer-events: none; /* å…è®¸ç‚¹å‡»ç©¿é€ */
            transform: translate(-50%, -50%);
            transition: width 0.1s ease-in-out, height 0.1s ease-in-out;
            z-index: 9999;
        }
        /* æ‚¬åœåœ¨å¯ç‚¹å‡»å…ƒç´ ä¸Šæ—¶ï¼Œå…‰æ ‡æ”¾å¤§ */
        body[data-cursor-hover="true"] .custom-cursor {
            width: 30px;
            height: 30px;
            background-color: rgba(167, 139, 250, 0.9);
        }

        /* æ ‡é¢˜å­—ä½“ */
        .font-mystic {
            font-family: 'Cormorant Garamond', serif;
            font-weight: 700;
        }

        /* è¾‰å…‰æ•ˆæœ - ç”¨äºæŒ‰é’®å’Œå›¾æ ‡ */
        .glow-effect {
            transition: all 0.3s ease;
            box-shadow: 0 0 15px 0px rgba(167, 139, 250, 0); /* é»˜è®¤æ— è¾‰å…‰ */
        }
        .glow-effect:hover {
            color: #fff;
            box-shadow: 0 0 25px 5px rgba(167, 139, 250, 0.6); /* æ‚¬åœæ—¶å‘å…‰ */
        }

        /* ç»“ç•Œï¼ˆçŒ«çœ¼ï¼‰ */
        .eye {
            width: 100px;
            height: 100px;
            background: #000;
            border-radius: 50%;
            position: relative;
            border: 3px solid #7000FF; /* é‚ªé­…ç´« */
            box-shadow: 0 0 20px #7000FF;
        }
        .pupil {
            width: 30px;
            height: 30px;
            background: #00FF85; /* é‚ªé­…ç»¿ */
            border-radius: 50%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border: 2px solid #000;
            transition: transform 0.1s linear;
        }

        /* é¡µé¢åˆ‡æ¢åŠ¨æ•ˆ */
        .page {
            display: none; /* é»˜è®¤éšè— */
            animation: fadeIn 1s ease-in-out;
        }
        .page.active {
            display: block; /* æ¿€æ´»æ—¶æ˜¾ç¤º */
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* å¡”ç½—ç‰Œ */
        .tarot-card {
            width: 150px;
            height: 250px;
            background: linear-gradient(145deg, #1f1a30, #130f20);
            border: 2px solid #a78bfa;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.4s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            perspective: 1000px;
        }
        .tarot-card:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: 0 10px 30px rgba(167, 139, 250, 0.4);
        }
        .tarot-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.8s;
            transform-style: preserve-3d;
        }
        .tarot-card.flipped .tarot-card-inner {
            transform: rotateY(180deg);
        }
        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 10px;
        }
        .card-back {
            background: linear-gradient(145deg, #19102A, #2a1a45);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        /* çŒ«çˆªç¬¦æ–‡ */
        .card-back-icon {
            font-size: 5rem;
            color: #a78bfa;
            opacity: 0.6;
        }
        .card-front {
            background-color: #130f20;
            transform: rotateY(180deg);
            flex-direction: column;
            justify-content: space-around;
        }
        
        /* æ°´æ™¶çƒ */
        .crystal-ball {
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(167, 139, 250, 0.3) 50%, rgba(112, 0, 255, 0.6) 100%);
            border-radius: 50%;
            border: 3px solid #a78bfa;
            box-shadow: 0 0 30px #a78bfa, inset 0 0 20px rgba(255,255,255,0.3);
            cursor: pointer;
            transition: all 0.3s ease;
            animation: pulseBall 4s infinite ease-in-out;
        }
        .crystal-ball:hover {
            box-shadow: 0 0 50px #c4b5fd, inset 0 0 30px rgba(255,255,255,0.5);
        }
        @keyframes pulseBall {
            0% { transform: scale(1); opacity: 0.8; }
            50% { transform: scale(1.03); opacity: 1; }
            100% { transform: scale(1); opacity: 0.8; }
        }

    </style>
</head>
<body class="min-h-screen w-full flex items-center justify-center transition-all duration-1000 ease-in-out">

    <!-- è‡ªå®šä¹‰å…‰æ ‡ -->
    <div class="custom-cursor"></div>

    <!-- 1. ç™»é™†é¡µ / ç»“ç•Œ -->
    <div id="splash-screen" class="fixed inset-0 w-full h-full flex flex-col items-center justify-center space-y-8 z-50" style="background-color: #100a1c;">
        <div class="flex space-x-16">
            <div class="eye" id="eye-left">
                <div class="pupil" id="pupil-left"></div>
            </div>
            <div class="eye" id="eye-right">
                <div class="pupil" id="pupil-right"></div>
            </div>
        </div>
        <h1 class="font-mystic text-3xl text-purple-300 tracking-widest animate-pulse">
            æ±ï¼Œæ‰€æ±‚ä¸ºä½•ï¼Ÿ
        </h1>
        <button id="enter-button" class="font-mystic text-lg text-gray-400 opacity-0 transition-opacity duration-1000 delay-1000 px-6 py-2 border border-purple-400 rounded-full hover:bg-purple-400 hover:text-black glow-effect">
            [ è½»æŠšé»‘çŒ« ]
        </button>
    </div>

    <!-- 2. ä¸»å†…å®¹åŒº (é»˜è®¤éšè—) -->
    <main id="main-content" class="w-full max-w-5xl mx-auto p-8 opacity-0 transition-opacity duration-1000" style="display: none;">
        
        <!-- å¯¼èˆª / å‘½è¿çš„å²”è·¯ -->
        <nav class="flex justify-center space-x-12 md:space-x-24 mb-12">
            <button class="nav-button glow-effect group" data-page="page-tarot">
                <span class="text-5xl group-hover:text-purple-300 transition-colors">ğŸ”®</span>
                <span class="font-mystic text-xl mt-2 block">è†å¬å¯ç¤º</span>
            </button>
            <button class="nav-button glow-effect group" data-page="page-market">
                <span class="text-5xl group-hover:text-purple-300 transition-colors">ğŸ¾</span>
                <span class="font-mystic text-xl mt-2 block">å¯»è§…å¥‡ç‰©</span>
            </button>
            <button class="nav-button glow-effect group" data-page="page-oracle">
                <span class="text-5xl group-hover:text-purple-300 transition-colors">âœ¨</span>
                <span class="font-mystic text-xl mt-2 block">é»‘çŒ«å›ç­”</span>
            </button>
        </nav>

        <!-- å†…å®¹åŒºåŸŸ -->
        <div id="content-area" class="text-center">

            <!-- å åœä¹‹é—´ (çŒ«çˆªå¡”ç½—) -->
            <div id="page-tarot" class="page">
                <h2 class="font-mystic text-4xl text-purple-300 mb-6">çŒ«çˆªå¡”ç½—</h2>
                <p class="text-lg text-gray-400 mb-10">é›†ä¸­ç²¾ç¥ï¼Œé»˜å¿µä½ çš„é—®é¢˜... ç„¶åï¼Œé€‰æ‹©ä¸€å¼ ç‰Œã€‚</p>
                
                <div id="tarot-deck" class="flex justify-center items-center space-x-6 min-h-[300px]">
                    <!-- JSå°†åœ¨è¿™é‡Œç”Ÿæˆå¡ç‰Œ -->
                </div>
                
                <div id="tarot-result" class="mt-10 min-h-[150px] p-6 bg-black/20 rounded-lg" style="display: none;">
                    <h3 id="tarot-card-name" class="font-mystic text-3xl text-purple-300"></h3>
                    <p id="tarot-card-interpretation" class="text-xl text-gray-300 mt-4"></p>
                </div>
            </div>

            <!-- æš—å½±é›†å¸‚ -->
            <div id="page-market" class="page">
                <h2 class="font-mystic text-4xl text-purple-300 mb-8">æš—å½±é›†å¸‚</h2>
                <p class="text-lg text-gray-400 mb-10">æ¥è‡ªé»‘çŒ«å·¥åŒ çš„å¥‡ç‰©ã€‚ä»…åœ¨åˆå¤œæ—¶åˆ†è¡¥è´§ã€‚</p>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-6 max-w-2xl mx-auto text-left">
                    <div class="market-item glow-effect p-4 border-l-2 border-purple-700 transition-all hover:bg-purple-900/30 hover:border-purple-400" onclick="showMarketModal(this)">
                        <h3 class="font-mystic text-2xl text-purple-300">é™„é­”çŒ«è–„è·æŠ¤èº«ç¬¦</h3>
                        <p class="text-gray-400">ç®€ä»‹ï¼šå¸å¼•ä¹æ¡å‘½çš„ç¥ç¦ã€‚</p>
                    </div>
                    <div class="market-item glow-effect p-4 border-l-2 border-purple-700 transition-all hover:bg-purple-900/30 hover:border-purple-400" onclick="showMarketModal(this)">
                        <h3 class="font-mystic text-2xl text-purple-300">å‡è§†æ·±æ¸ŠÂ·é©¬å…‹æ¯</h3>
                        <p class="text-gray-400">ç®€ä»‹ï¼šå½“ä½ å–å’–å•¡æ—¶ï¼Œå’–å•¡ä¹Ÿåœ¨å‡è§†ä½ ã€‚</p>
                    </div>
                    <div class="market-item glow-effect p-4 border-l-2 border-purple-700 transition-all hover:bg-purple-900/30 hover:border-purple-400" onclick="showMarketModal(this)">
                        <h3 class="font-mystic text-2xl text-purple-300">åˆå¤œä½è¯­Â·Tæ¤</h3>
                        <p class="text-gray-400">ç®€ä»‹ï¼šä¸Šé¢å°ç€ä½ å¬ä¸æ‡‚çš„å–µå–µå£°ã€‚</p>
                    </div>
                    <div class="market-item glow-effect p-4 border-l-2 border-purple-700 transition-all hover:bg-purple-900/30 hover:border-purple-400" onclick="showMarketModal(this)">
                        <h3 class="font-mystic text-2xl text-purple-300">é»‘çŒ«å·«å¸ˆä¼šå¾½ç« </h3>
                        <p class="text-gray-400">ç®€ä»‹ï¼šè¯æ˜ä½ è¢«é€‰ä¸­äº†ï¼ˆæˆ–è€…åªæ˜¯è¢«å®¹å¿ï¼‰ã€‚</p>
                    </div>
                </div>
            </div>

            <!-- é»‘çŒ«çš„å›ç­” (Yes/No) -->
            <div id="page-oracle" class="page">
                <h2 class="font-mystic text-4xl text-purple-300 mb-6">é»‘çŒ«çš„å›ç­”</h2>
                <p class="text-lg text-gray-400 mb-6">è¾“å…¥é‚£ä¸ªå›°æ‰°ä½ çš„ã€éé»‘-å³ç™½çš„é—®é¢˜ã€‚</p>
                
                <input id="oracle-question" type="text" placeholder="åœ¨æ­¤è¾“å…¥ä½ çš„é—®é¢˜..." class="w-full max-w-lg p-3 bg-gray-900/50 border border-purple-400 rounded-lg text-center text-white text-lg focus:outline-none focus:ring-2 focus:ring-purple-300">
                
                <div class="flex justify-center my-10">
                    <div id="crystal-ball-button" class="crystal-ball" role="button" aria-label="è·å–ç­”æ¡ˆ"></div>
                </div>
                
                <div id="oracle-result" class="mt-8 min-h-[100px] p-4">
                    <p id="oracle-answer-text" class="font-mystic text-4xl text-purple-200 transition-opacity duration-500 opacity-0"></p>
                </div>
            </div>

        </div>
    </main>
    
    <!-- å¸‚åœºå•†å“ æ¨¡æ€çª—å£ -->
    <div id="market-modal" class="fixed inset-0 bg-black/70 flex items-center justify-center p-4 z-40" style="display: none;">
        <div class="bg-gray-900 border border-purple-600 p-8 rounded-lg shadow-2xl max-w-md w-full text-center relative">
            <button onclick="hideMarketModal()" class="absolute top-4 right-4 text-gray-500 hover:text-white text-2xl">&times;</button>
            <h3 id="modal-item-name" class="font-mystic text-3xl text-purple-300 mb-4"></h3>
            <p class="text-lg text-gray-300">
                äººç±»çš„ç‚¼é‡‘æœ¯ï¼ˆæ”¯ä»˜ç³»ç»Ÿï¼‰æ­£åœ¨ç»´æŠ¤ä¸­ã€‚
                <br><br>
                é»‘çŒ«è®®ä¼šå·²è®°å½•ä½ çš„æ¸´æœ›ï¼Œæ—¶æœºæˆç†Ÿæ—¶ï¼Œå®ƒå°†å±äºä½ ã€‚
            </p>
        </div>
    </div>

    <script>
        // --- å åœæ•°æ® (æœ¬åœ°åŒ–) ---

        // çŒ«çˆªå¡”ç½—ç‰Œåº“ (ç®€åŒ–ç‰ˆ)
        const tarotDeckData = [
            { 
                name: "é»‘çŒ«Â·æ„šè€…", 
                interpretation: "é»‘çŒ«åœ¨æ‚¬å´–è¾¹ä¼¸äº†ä¸ªæ‡’è…°ã€‚â€”â€”æ˜¯æ—¶å€™éšå¿ƒæ‰€æ¬²åœ°è¿ˆå‡ºç¬¬ä¸€æ­¥äº†ï¼Œåˆ«æ‹…å¿ƒï¼Œä½ æ€»èƒ½å››è„šç€åœ°ã€‚" 
            },
            { 
                name: "æœˆäº®Â·å‡è§†", 
                interpretation: "é˜´å½±ä¸­æ½œè—ç€ä¸å®‰ï¼Œä½†ä¹Ÿéšè—ç€ç›´è§‰ã€‚ç›¸ä¿¡ä½ å†…å¿ƒçš„å–µå–µå«ï¼Œå³ä½¿é“è·¯æ¨¡ç³Šä¸æ¸…ã€‚" 
            },
            { 
                name: "å¤ªé˜³Â·æ‰“ç›¹", 
                interpretation: "ä¸‡ç‰©æ¸…æ™°è€Œæ¸©æš–ã€‚è¿™æ˜¯äº«å—å°é±¼å¹²ã€æ¥å—èµç¾å’Œæ”¾æ¾è‚šçš®çš„æœ€ä½³æ—¶æœºã€‚çº¯ç²¹çš„å–œæ‚¦ã€‚" 
            },
            { 
                name: "é­”æœ¯å¸ˆÂ·è‚‰å«", 
                interpretation: "ä½ æ¡Œä¸Šçš„ç“¶ç“¶ç½ç½ï¼ˆå’Œä½ çš„æ³¨æ„åŠ›ï¼‰éƒ½åœ¨å®ƒçš„æŒæ§ä¹‹ä¸­ã€‚ä½ æ‹¥æœ‰åˆ›é€ æ‰€éœ€çš„ä¸€åˆ‡ï¼Œåªéœ€ä¸€ç‚¹ç‚¹â€œæ··ä¹±â€ã€‚" 
            },
            { 
                name: "éšè€…Â·ç¯ç¬¼", 
                interpretation: "æ˜¯æ—¶å€™ç¼©å›ä½ çš„çº¸ç®±ï¼ˆå†…å¿ƒä¸–ç•Œï¼‰äº†ã€‚ç‹¬è‡ªæ€è€ƒï¼Œä½ ä¼šå‘ç°çˆªå­ä¸‹é‚£é¢—è¢«é—å¿˜çš„å¼¹ç ï¼ˆçœŸç›¸ï¼‰ã€‚" 
            }
        ];

        // é»‘çŒ«çš„å›ç­”åº“
        const oracleAnswers = [
            "å–µã€‚",
            "å˜¶... (å¦å®šçš„å˜¶å˜¶å£°)",
            "ä¹Ÿè®¸...ä½†ä½ å¾—å…ˆç»™æˆ‘å°é±¼å¹²ã€‚",
            "æˆ‘æ­£åœ¨æ‰“ç›¹ï¼Œæ™šç‚¹å†é—®ã€‚",
            "å®Œç¾çš„æ—¶æœºï¼å»å§ã€‚",
            "å®ƒä»æ¡Œä¸Šæ‰ä¸‹å»äº†ã€‚(ä»£è¡¨'ä¸')",
            "ä½ é—®äº†ä¸€åªçŒ«ã€‚ä½ è§‰å¾—å‘¢ï¼Ÿ(æ˜¯)",
            "å‘¼å™œå‘¼å™œ... (éå¸¸è‚¯å®š)",
            "é—®é¢˜ä¸åœ¨äºæ­¤ã€‚é—®é¢˜åœ¨äºï¼Œä½ çš„ç¢—æ˜¯ç©ºçš„ã€‚"
        ];

        // --- DOM å…ƒç´ å¼•ç”¨ ---
        const splashScreen = document.getElementById('splash-screen');
        const mainContent = document.getElementById('main-content');
        const enterButton = document.getElementById('enter-button');
        const contentArea = document.getElementById('content-area');
        const navButtons = document.querySelectorAll('.nav-button');
        const pages = document.querySelectorAll('.page');
        const customCursor = document.querySelector('.custom-cursor');
        const bodyEl = document.body;

        // --- 1. ç»“ç•Œ (çŒ«çœ¼) é€»è¾‘ ---
        const pupilLeft = document.getElementById('pupil-left');
        const pupilRight = document.getElementById('pupil-right');

        // çœ¼ç›è·Ÿéšå…‰æ ‡
        function moveEyes(event) {
            const x = (event.clientX / window.innerWidth) * 100;
            const y = (event.clientY / window.innerHeight) * 100;

            // è°ƒæ•´ç³å­”ä½ç½® (50%æ˜¯ä¸­å¿ƒ, æˆ‘ä»¬åœ¨ 40-60% ä¹‹é—´ç§»åŠ¨)
            const moveX = (x - 50) * 0.2;
            const moveY = (y - 50) * 0.2;
            
            const transformValue = `translate(calc(-50% + ${moveX}px), calc(-50% + ${moveY}px))`;
            
            pupilLeft.style.transform = transformValue;
            pupilRight.style.transform = transformValue;
        }

        // æ£€æŸ¥é¼ æ ‡æ˜¯å¦åœ¨çŒ«çœ¼é™„è¿‘ï¼Œæ˜¾ç¤ºè¿›å…¥æŒ‰é’®
        let proximityCheck;
        function checkProximity(event) {
            const eyes = document.querySelectorAll('.eye');
            let close = false;
            eyes.forEach(eye => {
                const rect = eye.getBoundingClientRect();
                const distance = Math.sqrt(
                    Math.pow(event.clientX - (rect.left + rect.width / 2), 2) +
                    Math.pow(event.clientY - (rect.top + rect.height / 2), 2)
                );
                if (distance < 100) { // é è¿‘çœ¼ç›
                    close = true;
                }
            });

            if (close) {
                enterButton.style.opacity = '1';
                clearTimeout(proximityCheck); // åœæ­¢è®¡æ—¶å™¨
            } else {
                // å¦‚æœé¼ æ ‡ç§»å¼€ï¼Œå»¶è¿Ÿéšè—æŒ‰é’®
                clearTimeout(proximityCheck);
                proximityCheck = setTimeout(() => {
                    enterButton.style.opacity = '0';
                }, 1000);
            }
        }
        
        window.addEventListener('mousemove', (event) => {
            moveEyes(event);
            if (mainContent.style.display === 'none') {
                checkProximity(event);
            }
            
            // æ›´æ–°è‡ªå®šä¹‰å…‰æ ‡ä½ç½®
            customCursor.style.left = event.clientX + 'px';
            customCursor.style.top = event.clientY + 'px';
        });

        // æŠšæ‘¸ (ç‚¹å‡») è¿›å…¥
        enterButton.addEventListener('click', () => {
            splashScreen.style.opacity = '0';
            splashScreen.style.pointerEvents = 'none'; // ç¡®ä¿å®ƒä¸èƒ½å†è¢«ç‚¹å‡»
            
            setTimeout(() => {
                splashScreen.style.display = 'none';
                mainContent.style.display = 'block';
                // å»¶è¿Ÿæ˜¾ç¤ºä¸»å†…å®¹
                setTimeout(() => {
                    mainContent.style.opacity = '1';
                }, 50);
                
                // é»˜è®¤æ˜¾ç¤ºå¡”ç½—ç‰Œé¡µé¢
                showPage('page-tarot');
            }, 1000); // ç­‰å¾…æ·¡å‡ºåŠ¨ç”»å®Œæˆ
        });


        // --- 2. é¡µé¢å¯¼èˆª ---
        navButtons.forEach(button => {
            button.addEventListener('click', () => {
                const pageId = button.getAttribute('data-page');
                showPage(pageId);
            });
        });

        function showPage(pageId) {
            pages.forEach(page => {
                if (page.id === pageId) {
                    page.classList.add('active');
                    // æ ¹æ®é¡µé¢å†…å®¹è§¦å‘ç‰¹å®šé€»è¾‘
                    if (pageId === 'page-tarot') {
                        setupTarotDeck();
                    }
                } else {
                    page.classList.remove('active');
                }
            });
        }

        // --- 3. å åœåŠŸèƒ½ (A) - çŒ«çˆªå¡”ç½— ---
        const tarotDeckContainer = document.getElementById('tarot-deck');
        const tarotResultContainer = document.getElementById('tarot-result');
        const tarotCardName = document.getElementById('tarot-card-name');
        const tarotCardInterpretation = document.getElementById('tarot-card-interpretation');

        let deckInitialized = false;

        function setupTarotDeck() {
            // é˜²æ­¢é‡å¤åˆå§‹åŒ–
            if (deckInitialized) {
                // å¦‚æœå·²ç»æŠ½è¿‡ç‰Œï¼Œé‡ç½®å¡ç»„
                if(tarotResultContainer.style.display !== 'none') {
                    resetTarotDeck();
                }
                return;
            };

            tarotDeckContainer.innerHTML = ''; // æ¸…ç©º
            tarotResultContainer.style.display = 'none';

            // æˆ‘ä»¬åªåˆ›å»º3å¼ ç‰ŒèƒŒï¼Œæ— è®ºç‰Œåº“å¤šå¤§ï¼Œå¢åŠ ç¥ç§˜æ„Ÿ
            for (let i = 0; i < 3; i++) {
                const card = document.createElement('div');
                card.className = 'tarot-card';
                card.innerHTML = `
                    <div class="tarot-card-inner">
                        <div class="card-face card-back">
                            <span class="card-back-icon">ğŸ¾</span>
                        </div>
                        <div class="card-face card-front">
                            <h4 class="card-name-front text-purple-300 font-mystic text-lg"></h4>
                            <p class="card-desc-front text-gray-400 text-sm"></p>
                        </div>
                    </div>
                `;
                
                card.addEventListener('click', () => drawTarot(card));
                tarotDeckContainer.appendChild(card);
            }
            deckInitialized = true;
        }
        
        function drawTarot(clickedCard) {
            // é˜²æ­¢é‡å¤ç‚¹å‡»
            if (clickedCard.classList.contains('flipped') || tarotDeckContainer.classList.contains('disabled')) {
                return;
            }
            
            // ç¦ç”¨ç‰Œç»„
            tarotDeckContainer.classList.add('disabled');

            // 1. éšæœºæŠ½ç‰Œ
            const randomIndex = Math.floor(Math.random() * tarotDeckData.length);
            const drawnCard = tarotDeckData[randomIndex];

            // 2. å¡«å……å¡é¢ä¿¡æ¯ (åœ¨ç¿»è½¬å‰)
            const frontName = clickedCard.querySelector('.card-name-front');
            const frontDesc = clickedCard.querySelector('.card-desc-front');
            frontName.textContent = drawnCard.name;
            frontDesc.textContent = drawnCard.interpretation.substring(0, 50) + "..."; // ç®€çŸ­æè¿°

            // 3. ç¿»è½¬å¡ç‰‡
            clickedCard.classList.add('flipped');
            
            // 4. è®©å…¶ä»–å¡ç‰‡æ¶ˆå¤±
            tarotDeckContainer.querySelectorAll('.tarot-card').forEach(card => {
                if (card !== clickedCard) {
                    card.style.opacity = '0';
                    card.style.transform = 'translateY(50px)';
                }
            });

            // 5. æ˜¾ç¤ºç»“æœ (å»¶è¿Ÿ)
            setTimeout(() => {
                tarotCardName.textContent = drawnCard.name;
                tarotCardInterpretation.textContent = drawnCard.interpretation;
                tarotResultContainer.style.display = 'block';
                tarotResultContainer.style.opacity = '0';
                setTimeout(() => { tarotResultContainer.style.opacity = '1'; }, 100);
                
                // æä¾›é‡ç½®é€‰é¡¹
                const resetButton = document.createElement('button');
                resetButton.textContent = "å†æ¬¡å åœ";
                resetButton.className = "mt-6 px-4 py-2 bg-purple-600 hover:bg-purple-500 rounded-full glow-effect";
                resetButton.onclick = resetTarotDeck;
                tarotResultContainer.appendChild(resetButton);

            }, 1000); // ç­‰å¾…ç¿»è½¬åŠ¨ç”»
        }
        
        function resetTarotDeck() {
            tarotDeckContainer.classList.remove('disabled');
            tarotResultContainer.style.display = 'none';
            tarotResultContainer.querySelector('button')?.remove(); // ç§»é™¤é‡ç½®æŒ‰é’®
            
            tarotDeckContainer.querySelectorAll('.tarot-card').forEach(card => {
                card.classList.remove('flipped');
                card.style.opacity = '1';
                card.style.transform = 'translateY(0) scale(1)';
            });
            deckInitialized = false; // å…è®¸é‡æ–°åˆå§‹åŒ–
            setupTarotDeck();
        }


        // --- 4. å åœåŠŸèƒ½ (B) - é»‘çŒ«çš„å›ç­” ---
        const oracleButton = document.getElementById('crystal-ball-button');
        const oracleQuestion = document.getElementById('oracle-question');
        const oracleAnswerText = document.getElementById('oracle-answer-text');

        oracleButton.addEventListener('click', () => {
            // æ£€æŸ¥æ˜¯å¦è¾“å…¥äº†é—®é¢˜ (ä»ªå¼æ„Ÿ)
            if (oracleQuestion.value.trim() === '') {
                oracleAnswerText.style.opacity = '0';
                setTimeout(() => {
                    oracleAnswerText.textContent = "ä½ å¿…é¡»å…ˆæé—®ï¼Œå–µ...";
                    oracleAnswerText.style.opacity = '1';
                }, 100);
                return;
            }

            // 1. å¼€å§‹åŠ¨ç”»
            oracleAnswerText.style.opacity = '0';
            oracleButton.style.animation = 'pulseBall 0.5s 2 ease-in-out'; // å¿«é€Ÿè„‰åŠ¨ä¸¤æ¬¡
            
            // 2. éšæœºè·å–ç­”æ¡ˆ
            const randomIndex = Math.floor(Math.random() * oracleAnswers.length);
            const answer = oracleAnswers[randomIndex];

            // 3. å»¶è¿Ÿæ˜¾ç¤ºç­”æ¡ˆ
            setTimeout(() => {
                oracleAnswerText.textContent = answer;
                oracleAnswerText.style.opacity = '1';
                oracleButton.style.animation = 'pulseBall 4s infinite ease-in-out'; // æ¢å¤æ­£å¸¸è„‰åŠ¨
                oracleQuestion.value = ''; // æ¸…ç©ºé—®é¢˜
            }, 1000); // ç­‰å¾…åŠ¨ç”»
        });

        // --- 5. æš—å½±é›†å¸‚ æ¨¡æ€çª—å£ ---
        const marketModal = document.getElementById('market-modal');
        const modalItemName = document.getElementById('modal-item-name');

        function showMarketModal(itemElement) {
            const itemName = itemElement.querySelector('h3').textContent;
            modalItemName.textContent = itemName;
            marketModal.style.display = 'flex';
            setTimeout(() => { marketModal.style.opacity = '1'; }, 10); // è§¦å‘æ·¡å…¥
        }

        function hideMarketModal() {
            marketModal.style.opacity = '0';
            setTimeout(() => { marketModal.style.display = 'none'; }, 300); // ç­‰å¾…æ·¡å‡º
        }
        // ç‚¹å‡»æ¨¡æ€æ¡†èƒŒæ™¯ä¹Ÿå¯å…³é—­
        marketModal.addEventListener('click', (e) => {
            if (e.target === marketModal) {
                hideMarketModal();
            }
        });

        // --- 6. è‡ªå®šä¹‰å…‰æ ‡äº¤äº’ ---
        // ç›‘å¬å¯ç‚¹å‡»å…ƒç´ 
        document.addEventListener('mouseover', (e) => {
            // æ£€æŸ¥å…ƒç´ æˆ–å…¶çˆ¶å…ƒç´ æ˜¯å¦æ˜¯å¯ç‚¹å‡»çš„
            if (e.target.matches('button, [role="button"], a, input, .tarot-card, .market-item')) {
                bodyEl.setAttribute('data-cursor-hover', 'true');
            } else {
                bodyEl.setAttribute('data-cursor-hover', 'false');
            }
        });

    </script>
</body>
</html>